<div class="row">
  <div class="col-md-8">
    <% @job.images.each.with_index do |image, index| %>
      <canvas class="mousetrap" id="<%= index.to_s + '_' +@job.id.to_s %>" width="800" height="1025" \
       style="background: url(<%= image %>); no-repeat; border:1px solid #000000"></canvas>
    <% end %>
  </div>

  <div class="col-md-offset-1 col-md-3">
    <div class="card" style="position: fixed; width: 250px;">
      <div class="card-block">
        <%= link_to 'Back', course_exam_jobs_path(@course, @exam) %>
        <div class="card-title">
          <% if @job.previous(current_teacher.id, @exam.id).present? %>
            <a id="js-left" href="<%= course_exam_job_path(@course, @exam, @job.previous(current_teacher.id, @exam.id))  %>">
            <span  class="mega-octicon really-more-mega octicon-arrow-left" style="float: left;"></span></a>
          <% end %>
          <% if @job.next(current_teacher.id, @exam.id).present? %>
            <a id="js-right" href="<%= course_exam_job_path(@course, @exam, @job.next(current_teacher.id, @exam)) %>">
            <span class="mega-octicon really-more-mega octicon-arrow-right" style="float: right;"></span></a>
          <% end %>
        </div>

        <div class="card-text">

          <h1 style="text-align: center;"><%= @question.mark %></h1>
            ===========================
            <% @pqs.each do |pq|  %>
              <li><%= pq.sub_tag %> - <%= pq.mark %></li>
            <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
	$(document).ready(function() {
		var canvas = $('.mousetrap')[0];
		paper.setup(canvas);
    var path;
    var tool = new paper.Tool();
    tool.minDistance = 20;
    tool.onMouseDown = function(event) {
      if (path) {
		      path.selected = false;
	    };
      path = new paper.Path();
    	path.strokeColor = 'black';
    }
    tool.onMouseDrag = function(event) {
    	path.add(event.point);
    }
    tool.onMouseUp = function(event) {
    	path.smooth();
    }
    tool.onKeyDown = function(event) {
      if(paper.Key.isDown('a')) {
		      console.log(path)
      }

      if(paper.Key.isDown('r')){
        path.strokeColor = 'red';
      }
    }
	});
</script>
